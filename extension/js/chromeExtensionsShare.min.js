function UserExtensions(){this.enabled={};this.disabled={};this.apps={};this.countSelected=function(){return Object.keys(this.enabled).length+Object.keys(this.disabled).length+Object.keys(this.apps).length};this.countEnabled=function(){return Object.keys(this.enabled).length};this.countDisabled=function(){return Object.keys(this.disabled).length};this.countApps=function(){return Object.keys(this.apps).length};this.getImageUrl=function(a){var d=0,b="images/extension.png";if(a.enabled&&void 0!=a.icons&&
a.icons.length)for(var c in a.icons)d<a.icons[c].size&&(d=a.icons[c].size,b=a.icons[c].url);return b}}
function ExtensionsShare(){this._extensionInfos=new UserExtensions;this._lastExportType="text";this._template=null;this.setTemplate=function(a){this._template=a};this.exportTo=function(a){console.log("exporting to:"+a);var d=$("#description:checked").val();this._lastExportType=a;var b=new UserExtensions,c;for(c in this._extensionInfos.enabled){var e=this._extensionInfos.enabled[c];$("#"+e.id).hasClass("selected")&&(b.enabled[e.id]=e)}for(c in this._extensionInfos.disabled)e=this._extensionInfos.disabled[c],
$("#"+e.id).hasClass("selected")&&(b.disabled[e.id]=e);for(c in this._extensionInfos.apps)e=this._extensionInfos.apps[c],$("#"+e.id).hasClass("selected")&&(b.apps[e.id]=e);if(0==b.countSelected())alert(_i18n("alert_no_extensions_selected"));else{c="";_gaq.push(["_trackPageview","/extensions/export/"+a+"/"+b.countSelected()+"/"]);switch(a){case "bbcode":c=generateBBCode(b,d);break;case "html":c=generateHTML(b,d);break;case "text":c=generateText(b,d);break;case "wiki":c=generateWiki(b,d)}$("#nav2 li.selected").removeClass("selected");
void 0!=c&&""!=c&&($("#export").val(c),$("#nav2 li."+a).addClass("selected"),$("#dialog-modal").dialog({modal:!0,draggable:!1,position:"center",width:800,height:600,closeOnEscape:!0}))}};this.reExport=function(){this.exportTo(this._lastExportType)};this.populateExtensions=function(a){this._extensionInfos=new UserExtensions;for(var d in a){var b=a[d];b.isApp?this._extensionInfos.apps[b.id]=b:b.enabled?this._extensionInfos.enabled[b.id]=b:this._extensionInfos.disabled[b.id]=b}$(".content").append(getSectionHeader(_i18n("section_header_title_enabled_extensions"),
this._extensionInfos.countEnabled(),"enabled"));for(d in this._extensionInfos.enabled)$(".content").append(this.populateData($(this._template).clone(),this._extensionInfos.enabled[d]));$(".content").append(getSectionHeader(_i18n("section_header_title_disabled_extensions"),this._extensionInfos.countDisabled(),"disabled"));for(d in this._extensionInfos.disabled)$(".content").append(this.populateData(this._template,this._extensionInfos.disabled[d]));$(".content").append(getSectionHeader(_i18n("section_header_title_apps"),
this._extensionInfos.countApps(),"app"));for(d in this._extensionInfos.apps)$(".content").append(this.populateData(this._template,this._extensionInfos.apps[d]));return this._extensionInfos.countSelected()};this.getLastExportType=function(){return this._lastExportType};this.getExtensionInfoById=function(a){if("undefined"!=typeof this._extensionInfos.enabled[a])return this._extensionInfos.enabled[a];if("undefined"!=typeof this._extensionInfos.disabled[a])return this._extensionInfos.disabled[a];if("undefined"!=
typeof this._extensionInfos.apps[a])return this._extensionInfos.apps[a]};this.populateData=function(a,d){$(".extension",a).attr("id",d.id);d.isApp?($("#icon",a).attr("src",this._extensionInfos.getImageUrl(d)),$(".extension",a).addClass("app").removeClass("enabled").removeClass("disabled"),$("#action_disable",a).addClass("hd"),$("#action_enable",a).addClass("hd")):d.enabled?($("#icon",a).attr("src",this._extensionInfos.getImageUrl(d)),$(".extension",a).addClass("enabled"),$(".extension",a).removeClass("disabled"),
$("#action_disable",a).removeClass("hd"),$("#action_enable",a).addClass("hd")):($("#icon",a).attr("src","images/extension_unknown.png"),$(".extension",a).addClass("disabled"),$(".extension",a).removeClass("enabled"),$("#action_disable",a).addClass("hd"),$("#action_enable",a).removeClass("hd"));$("#name2",a).hide();$("#name",a).html(d.name);$(".inspectPopupNote",a).html(d.description);$(".extension-description",a).html(d.description);$("#homepageUrl",a).attr("href","https://chrome.google.com/webstore/detail/"+
d.id);$("#version",a).html(d.version);$("#enabled",a).hide();$("#id",a).html(d.id);return a.html()};this.getImageUrl=function(a){return this._extensionInfos.getImageUrl(a)}}function selectAll(a){a?$(".extension").addClass("selected"):$(".extension").removeClass("selected")}
function selectExtensions(a){console.log("select",a);_gaq.push(["_trackPageview","/extensions/select/"+a+"/"]);switch(a){case "all":$(".extension").addClass("selected");break;case "none":$(".extension").removeClass("selected");break;case "revert":$(".extension").each(function(){$(this).hasClass("selected")?$(this).removeClass("selected"):$(this).addClass("selected")})}return!1}
function sendTo(a){a=encodeURIComponent($("#export").val());console.log(a.length);var d=!0;1793<a.length&&(d=confirm(_i18n("export_mail_size_warning")));d&&(_gaq.push(["_trackPageview","/extensions/export/gmail/"]),window.open("https://mail.google.com/mail/?view=cm&fs=1&tf=1&su="+encodeURIComponent(_i18n("title_export_mail"))+"&body="+a));return!1}
function generateBBCode(a,d){var b=new Date,b="[b]"+_i18n("label_export_generated")+"[/b] "+b.toGMTString()+"\n",b=b+"[b]"+_i18n("label_export_user_agent")+"[/b] "+navigator.userAgent+"\n",b=b+"\n[b]"+_i18n("label_export_extensions")+"[/b] "+Object.keys(a.enabled).length+"\n",c;for(c in a.enabled)var e=a.enabled[c],b=b+getBBCodeData(e,d);b=b+"[b]"+_i18n("label_export_extensions_disabled")+"[/b] "+Object.keys(a.disabled).length+"\n";for(c in a.disabled)e=a.disabled[c],b+=getBBCodeData(e,d);b=b+"[b]"+
_i18n("label_export_apps")+"[/b] "+Object.keys(a.apps).length+"\n";for(c in a.apps)e=a.apps[c],b+=getBBCodeData(e,d);return b=b+"\n"+_i18n("label_exported_via_bbcode")+"\n"}function getBBCodeData(a,d){var b="- [url=https://chrome.google.com/webstore/detail/"+a.id+"]"+a.name+"[/url] v"+a.version+"\n";d&&(void 0!=a.description&&""!=a.description)&&(b=b+" [i]"+a.description+"[/i]\n");return b+"\n"}
function generateHTML(a,d){var b=new Date,c;c='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">\n<html><head><title>'+_i18n("title_export_html")+"</title>\n";c+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8">\n';c+='<base target="_blank">\n';c+="</head>\n";c+="<body>\n";c=c+"<b>"+_i18n("label_export_generated")+"</b> "+b.toGMTString()+"<br>\n";c=c+"<b>"+_i18n("label_export_user_agent")+"</b> "+navigator.userAgent+"<br>\n";c+="<br>\n";c=c+"<b>"+_i18n("label_export_extensions")+
"</b> "+Object.keys(a.enabled).length+"";c+="<ul>";for(var e in a.enabled)b=a.enabled[e],c+=getHTMLData(b,d);c+="</ul>\n";c+="<br>\n";c=c+"<b>"+_i18n("label_export_extensions_disabled")+"</b> "+Object.keys(a.disabled).length+"";c+="<ul>";for(e in a.disabled)b=a.disabled[e],c+=getHTMLData(b,d);c+="</ul>\n";c+="<br>\n";c=c+"<b>"+_i18n("label_export_apps")+"</b> "+Object.keys(a.apps).length+"";c+="<ul>";for(e in a.apps)b=a.apps[e],c+=getHTMLData(b,d);c+="</ul>\n";c=c+"<br><br>"+_i18n("label_exported_via_html")+
"\n";return c+="</body></html>\n"}function getHTMLData(a,d){var b='<li> <a href="https://chrome.google.com/webstore/detail/'+a.id+'" target="_blank">'+a.name+"</a> v"+a.version;d&&(void 0!=a.description&&""!=a.description)&&(b=b+"<br><i>"+a.description+"</i>");return b+="</li>\n\n"}
function generateText(a,d){var b=new Date,b=""+_i18n("label_export_generated")+" "+b.toGMTString()+"\n",b=b+_i18n("label_export_user_agent")+" "+navigator.userAgent+"\n",b=b+"\n"+_i18n("label_export_extensions")+" "+a.countEnabled()+"\n",c;for(c in a.enabled)var e=a.enabled[c],b=b+getDescriptionText(e,d);b=b+"\n"+_i18n("label_export_extensions_disabled")+" "+a.countDisabled()+"\n";for(c in a.disabled)e=a.disabled[c],b+=getDescriptionText(e,d);b=b+"\n"+_i18n("label_export_apps")+" "+a.countApps()+
"\n";for(c in a.apps)e=a.apps[c],b+=getDescriptionText(e,d);return b=b+"\n\n"+_i18n("label_exported_via_text")+"\n"}function getDescriptionText(a,d){var b="- "+a.name+" v"+a.version+": https://chrome.google.com/webstore/detail/"+a.id+"\n";d&&(b=b+"   "+a.description+"\n");return b}
function getTextData(a,d){var b="- [url=https://chrome.google.com/webstore/detail/"+a.id+"]"+a.name+"[/url] v"+a.version+"\n";d&&(void 0!=a.description&&""!=a.description)&&(b=b+" [i]"+a.description+"[/i]\n");return b+"\n"}
function generateWiki(a,d){var b=new Date,b="'''"+_i18n("label_export_generated")+"''' "+b.toGMTString()+"\n\n",b=b+"'''"+_i18n("label_export_user_agent")+"''' "+navigator.userAgent+"\n",b=b+"\n'''"+_i18n("label_export_extensions")+" "+a.countEnabled()+"''' \n",c;for(c in a.enabled)var e=a.enabled[c],b=b+getWikiData(e,d);b=b+"\n'''"+_i18n("label_export_extensions_disabled")+" "+a.countDisabled()+"'''\n";for(c in a.disabled)e=a.disabled[c],b+=getWikiData(e,d);b=b+"\n'''"+_i18n("label_export_apps")+
" "+a.countApps()+"'''\n";for(c in a.apps)e=a.apps[c],b+=getWikiData(e,d);return b=b+"\n\n"+_i18n("label_exported_via_wiki")+"\n"}function getWikiData(a,d){var b="* [https://chrome.google.com/webstore/detail/"+a.id+" "+a.name+"] v"+a.version+"\n";d&&(void 0!=a.description&&""!=a.description)&&(b=b+":''"+a.description+"''\n");return b+"\n"}
function getSectionHeader(a,d,b){var c=$("#splitter-template").clone();$(c).removeClass("template");$(c).attr("id","splitter-"+b);$("#extensions_title",c).html(a);$("#extensions_length",c).html(d);return c}
chrome.management.onDisabled.addListener(function(a){_gaq.push(["_trackPageview","/extensions/action/disable/"+a.id+"/"+a.name]);$("#"+a.id+" #icon").attr("src","images/extension_unknown.png");$("#action_enable",$("#"+a.id)).show();extensionsShare._extensionInfos.disabled[a.id]=extensionsShare._extensionInfos.enabled[a.id];delete extensionsShare._extensionInfos.enabled[a.id]});
chrome.management.onEnabled.addListener(function(a){_gaq.push(["_trackPageview","/extensions/action/enable/"+a.id+"/"+a.name]);$("#action_disable",$("#"+a.id)).show();$("#"+a.id+" #icon").attr("src",extensionsShare.getImageUrl(a));extensionsShare._extensionInfos.enabled[a.id]=extensionsShare._extensionInfos.disabled[a.id];delete extensionsShare._extensionInfos.disabled[a.id]});
function doI18n(){$("[nodeName=title]").html(_i18n("default_title"));$(".i18n").each(function(){$(this).html(_i18n($(this).attr("id")))});$(".i18nt").each(function(){$(this).attr("title",_i18n($(this).attr("id")))})}
function addListeners(){$(".Wp").toggle(function(){$(this).addClass("Wo").removeClass("Wi");$(".extension."+$(this).parents(".splitter").attr("id").replace("splitter-","")).addClass("hd")},function(){$(this).addClass("Wi").removeClass("Wo");$(".extension."+$(this).parents(".splitter").attr("id").replace("splitter-","")).removeClass("hd")});$(".action").tipTip({maxWidth:"auto",edgeOffset:2,fadeIn:0,fadeOut:0});$("#description").click(function(){_gaq.push(["_trackPageview","/option/description/"+extensionsShare.getLastExportType()+
"/"+$("#description").val()]);extensionsShare.reExport()});$(".ui-widget-overlay").live("click",function(){$("#dialog-modal").dialog("close")});$(".extension").hover(function(){$(".extension-actions",this).show()},function(){$(".extension-actions",this).hide()}).click(function(){$(this).hasClass("selected")?$(this).removeClass("selected"):$(this).addClass("selected")});$(".stars").toggle(function(){$(this).addClass("selected");$(this).parents(".extension").addClass("selected")},function(){$(this).removeClass("selected");
$(this).parents(".extension").removeClass("selected")});$("span#share_twitter").click(function(){var a=extensionsShare.getExtensionInfoById($(this).parents(".extension").attr("id"));if(null!=a){var d=" Chrome Extension";a.isApp&&(d=" Chrome App");_gaq.push(["_trackPageview","/extensions/share/twitter/"+a.id+"/"+a.name]);a=encodeURIComponent(a.name+d)+"&url="+encodeURIComponent("https://chrome.google.com/webstore/detail/"+a.id);window.open("http://twitter.com/share?_=1299226766058&count=horizontal&text="+
a+"&via=ShareExtensions");return!1}});$("span#share_buzz").click(function(){var a=extensionsShare.getExtensionInfoById($(this).parents(".extension").attr("id"));if(null!=a){var d=" Chrome Extension";a.isApp&&(d=" Chrome App");_gaq.push(["_trackPageview","/extensions/share/buzz/"+a.id+"/"+a.name]);window.open("http://www.google.com/buzz/post?message="+encodeURIComponent(a.name+d)+"&imageurl="+encodeURIComponent("https://chrome.google.com/webstore/img/"+a.id+"/2323432/logo128")+"&url="+encodeURIComponent("https://chrome.google.com/webstore/detail/"+
a.id));return!1}});$("span#share_gmail").click(function(){var a=extensionsShare.getExtensionInfoById($(this).parents(".extension").attr("id"));if(null!=a){var d=_i18n("title_export_mail");a.isApp&&(d=_i18n("title_export_mail_app"));_gaq.push(["_trackPageview","/extensions/share/mail/"+a.id+"/"+a.name]);window.open("https://mail.google.com/mail/?view=cm&fs=1&tf=1&su="+encodeURIComponent(d)+"&body="+encodeURIComponent(getDescriptionText(a,!0)));return!1}});$("span#share_glist").click(function(){var a=
extensionsShare.getExtensionInfoById($(this).parents(".extension").attr("id"));if(null!=a)return _i18n("title_export_mail"),a.isApp&&_i18n("title_export_mail_app"),_gaq.push(["_trackPageview","/extensions/share/glist/"+a.id+"/"+a.name]),window.open("https://www.google.com/bookmarks/api/bookmarklet?output=popup&srcUrl="+encodeURIComponent("https://chrome.google.com/webstore/detail/"+a.id)+"&snippet="+encodeURIComponent(a.description)+"&title="+encodeURIComponent(a.name)),!1});$("span#action_enable").click(function(){$(this).hide();
chrome.management.setEnabled($(this).parents(".extension").attr("id"),!0);return!1});$("span#action_disable").click(function(){$(this).hide();chrome.management.setEnabled($(this).parents(".extension").attr("id"),!1);return!1})};