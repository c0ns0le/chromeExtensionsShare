function UserExtensions(){this.enabled={};this.disabled={};this.apps={};this.countSelected=function(){return Object.keys(this.enabled).length+Object.keys(this.disabled).length+Object.keys(this.apps).length};this.countEnabled=function(){return Object.keys(this.enabled).length};this.countDisabled=function(){return Object.keys(this.disabled).length};this.countApps=function(){return Object.keys(this.apps).length};this.getImageUrl=function(a){var d=0,c="images/extension.png";if(a.enabled&&a.icons!=undefined&&
a.icons.length)for(var b in a.icons)if(d<a.icons[b].size){d=a.icons[b].size;c=a.icons[b].url}return c}}
function ExtensionsShare(){this._extensionInfos=new UserExtensions;this._lastExportType="text";this._template=null;this.setTemplate=function(a){this._template=a};this.exportTo=function(a){console.log("exporting to:"+a);var d=$("#description:checked").val();this._lastExportType=a;var c=new UserExtensions,b;for(b in this._extensionInfos.enabled){var e=this._extensionInfos.enabled[b];if($("#"+e.id).hasClass("selected"))c.enabled[e.id]=e}for(b in this._extensionInfos.disabled){e=this._extensionInfos.disabled[b];
if($("#"+e.id).hasClass("selected"))c.disabled[e.id]=e}for(b in this._extensionInfos.apps){e=this._extensionInfos.apps[b];if($("#"+e.id).hasClass("selected"))c.apps[e.id]=e}if(c.countSelected()==0)alert(_i18n("alert_no_extensions_selected"));else{b="";_gaq.push(["_trackPageview","/extensions/export/"+a+"/"+c.countSelected()+"/"]);switch(a){case "bbcode":b=generateBBCode(c,d);break;case "html":b=generateHTML(c,d);break;case "text":b=generateText(c,d);break;case "wiki":b=generateWiki(c,d)}$("#nav2 li.selected").removeClass("selected");
if(b!=undefined&&b!=""){$("#export").val(b);$("#nav2 li."+a).addClass("selected");$("#dialog-modal").dialog({modal:true,draggable:false,position:"center",width:800,height:600,closeOnEscape:true})}}};this.reExport=function(){this.exportTo(this._lastExportType)};this.populateExtensions=function(a){this._extensionInfos=new UserExtensions;for(var d in a){var c=a[d];if(c.isApp)this._extensionInfos.apps[c.id]=c;else if(c.enabled)this._extensionInfos.enabled[c.id]=c;else this._extensionInfos.disabled[c.id]=
c}$(".content").append(getSectionHeader(_i18n("section_header_title_enabled_extensions"),this._extensionInfos.countEnabled(),"enabled"));for(d in this._extensionInfos.enabled)$(".content").append(this.populateData($(this._template).clone(),this._extensionInfos.enabled[d]));$(".content").append(getSectionHeader(_i18n("section_header_title_disabled_extensions"),this._extensionInfos.countDisabled(),"disabled"));for(d in this._extensionInfos.disabled)$(".content").append(this.populateData(this._template,
this._extensionInfos.disabled[d]));$(".content").append(getSectionHeader(_i18n("section_header_title_apps"),this._extensionInfos.countApps(),"app"));for(d in this._extensionInfos.apps)$(".content").append(this.populateData(this._template,this._extensionInfos.apps[d]));return this._extensionInfos.countSelected()};this.getLastExportType=function(){return this._lastExportType};this.getExtensionInfoById=function(a){if(typeof this._extensionInfos.enabled[a]!="undefined")return this._extensionInfos.enabled[a];
if(typeof this._extensionInfos.disabled[a]!="undefined")return this._extensionInfos.disabled[a];if(typeof this._extensionInfos.apps[a]!="undefined")return this._extensionInfos.apps[a]};this.populateData=function(a,d){$(".extension",a).attr("id",d.id);if(d.isApp){$("#icon",a).attr("src",this._extensionInfos.getImageUrl(d));$(".extension",a).addClass("app").removeClass("enabled").removeClass("disabled");$("#action_disable",a).addClass("hd");$("#action_enable",a).addClass("hd")}else if(d.enabled){$("#icon",
a).attr("src",this._extensionInfos.getImageUrl(d));$(".extension",a).addClass("enabled");$(".extension",a).removeClass("disabled");$("#action_disable",a).removeClass("hd");$("#action_enable",a).addClass("hd")}else{$("#icon",a).attr("src","images/extension_unknown.png");$(".extension",a).addClass("disabled");$(".extension",a).removeClass("enabled");$("#action_disable",a).addClass("hd");$("#action_enable",a).removeClass("hd")}$("#name2",a).hide();$("#name",a).html(d.name);$(".inspectPopupNote",a).html(d.description);
$(".extension-description",a).html(d.description);$("#homepageUrl",a).attr("href","https://chrome.google.com/webstore/detail/"+d.id);$("#version",a).html(d.version);$("#enabled",a).hide();$("#id",a).html(d.id);return a.html()};this.getImageUrl=function(a){return this._extensionInfos.getImageUrl(a)}}function selectAll(a){a?$(".extension").addClass("selected"):$(".extension").removeClass("selected")}
function select(a){_gaq.push(["_trackPageview","/extensions/select/"+a+"/"]);switch(a){case "all":$(".extension").addClass("selected");break;case "none":$(".extension").removeClass("selected");break;case "reverse":$(".extension").each(function(){$(this).hasClass("selected")?$(this).removeClass("selected"):$(this).addClass("selected")})}return false}
function sendTo(){var a=encodeURIComponent($("#export").val());console.log(a.length);var d=true;if(a.length>1793)d=confirm(_i18n("export_mail_size_warning"));if(d){_gaq.push(["_trackPageview","/extensions/export/gmail/"]);window.open("https://mail.google.com/mail/?view=cm&fs=1&tf=1&su="+encodeURIComponent(_i18n("title_export_mail"))+"&body="+a)}return false}
function generateBBCode(a,d){var c=new Date,b="";b=b+"[b]"+_i18n("label_export_generated")+"[/b] "+c.toGMTString()+"\n";b=b+"[b]"+_i18n("label_export_user_agent")+"[/b] "+navigator.userAgent+"\n";b+="\n";b=b+"[b]"+_i18n("label_export_extensions")+"[/b] "+Object.keys(a.enabled).length+"\n";for(var e in a.enabled){c=a.enabled[e];b+=getBBCodeData(c,d)}b=b+"[b]"+_i18n("label_export_extensions_disabled")+"[/b] "+Object.keys(a.disabled).length+"\n";for(e in a.disabled){c=a.disabled[e];b+=getBBCodeData(c,
d)}b=b+"[b]"+_i18n("label_export_apps")+"[/b] "+Object.keys(a.apps).length+"\n";for(e in a.apps){c=a.apps[e];b+=getBBCodeData(c,d)}return b=b+"\n"+_i18n("label_exported_via_bbcode")+"\n"}function getBBCodeData(a,d){var c="- [url=https://chrome.google.com/webstore/detail/"+a.id+"]"+a.name+"[/url] v"+a.version+"\n";if(d&&a.description!=undefined&&a.description!="")c=c+" [i]"+a.description+"[/i]\n";c+="\n";return c}
function generateHTML(a,d){var c=new Date,b="";b+='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">\n';b=b+"<html><head><title>"+_i18n("title_export_html")+"</title>\n";b+='<meta http-equiv="Content-Type" content="text/html; charset=utf-8">\n';b+='<base target="_blank">\n';b+="</head>\n";b+="<body>\n";b=b+"<b>"+_i18n("label_export_generated")+"</b> "+c.toGMTString()+"<br>\n";b=b+"<b>"+_i18n("label_export_user_agent")+"</b> "+navigator.userAgent+"<br>\n";b+="<br>\n";b=b+"<b>"+_i18n("label_export_extensions")+
"</b> "+Object.keys(a.enabled).length+"";b+="<ul>";for(var e in a.enabled){c=a.enabled[e];b+=getHTMLData(c,d)}b+="</ul>\n";b+="<br>\n";b=b+"<b>"+_i18n("label_export_extensions_disabled")+"</b> "+Object.keys(a.disabled).length+"";b+="<ul>";for(e in a.disabled){c=a.disabled[e];b+=getHTMLData(c,d)}b+="</ul>\n";b+="<br>\n";b=b+"<b>"+_i18n("label_export_apps")+"</b> "+Object.keys(a.apps).length+"";b+="<ul>";for(e in a.apps){c=a.apps[e];b+=getHTMLData(c,d)}b+="</ul>\n";b=b+"<br><br>"+_i18n("label_exported_via_html")+
"\n";b+="</body></html>\n";return b}function getHTMLData(a,d){var c='<li> <a href="https://chrome.google.com/webstore/detail/'+a.id+'" target="_blank">'+a.name+"</a> v"+a.version;if(d&&a.description!=undefined&&a.description!="")c=c+"<br><i>"+a.description+"</i>";c+="</li>\n";c+="\n";return c}
function generateText(a,d){var c=new Date,b="";b=b+_i18n("label_export_generated")+" "+c.toGMTString()+"\n";b=b+_i18n("label_export_user_agent")+" "+navigator.userAgent+"\n";b+="\n";b=b+_i18n("label_export_extensions")+" "+a.countEnabled()+"\n";for(var e in a.enabled){c=a.enabled[e];b+=getDescriptionText(c,d)}b=b+"\n"+_i18n("label_export_extensions_disabled")+" "+a.countDisabled()+"\n";for(e in a.disabled){c=a.disabled[e];b+=getDescriptionText(c,d)}b=b+"\n"+_i18n("label_export_apps")+" "+a.countApps()+
"\n";for(e in a.apps){c=a.apps[e];b+=getDescriptionText(c,d)}return b=b+"\n\n"+_i18n("label_exported_via_text")+"\n"}function getDescriptionText(a,d){var c="- "+a.name+" v"+a.version+": https://chrome.google.com/webstore/detail/"+a.id+"\n";if(d)c=c+"   "+a.description+"\n";return c}
function getTextData(a,d){var c="- [url=https://chrome.google.com/webstore/detail/"+a.id+"]"+a.name+"[/url] v"+a.version+"\n";if(d&&a.description!=undefined&&a.description!="")c=c+" [i]"+a.description+"[/i]\n";c+="\n";return c}
function generateWiki(a,d){var c=new Date,b="";b=b+"'''"+_i18n("label_export_generated")+"''' "+c.toGMTString()+"\n\n";b=b+"'''"+_i18n("label_export_user_agent")+"''' "+navigator.userAgent+"\n";b+="\n";b=b+"'''"+_i18n("label_export_extensions")+" "+a.countEnabled()+"''' \n";for(var e in a.enabled){c=a.enabled[e];b+=getWikiData(c,d)}b=b+"\n'''"+_i18n("label_export_extensions_disabled")+" "+a.countDisabled()+"'''\n";for(e in a.disabled){c=a.disabled[e];b+=getWikiData(c,d)}b=b+"\n'''"+_i18n("label_export_apps")+
" "+a.countApps()+"'''\n";for(e in a.apps){c=a.apps[e];b+=getWikiData(c,d)}return b=b+"\n\n"+_i18n("label_exported_via_wiki")+"\n"}function getWikiData(a,d){var c="* [https://chrome.google.com/webstore/detail/"+a.id+" "+a.name+"] v"+a.version+"\n";if(d&&a.description!=undefined&&a.description!="")c=c+":''"+a.description+"''\n";c+="\n";return c}
function getSectionHeader(a,d,c){var b=$("#splitter-template").clone();$(b).removeClass("template");$(b).attr("id","splitter-"+c);$("#extensions_title",b).html(a);$("#extensions_length",b).html(d);return b}
chrome.management.onDisabled.addListener(function(a){_gaq.push(["_trackPageview","/extensions/action/disable/"+a.id+"/"+a.name]);$("#"+a.id+" #icon").attr("src","images/extension_unknown.png");$("#action_enable",$("#"+a.id)).show();extensionsShare._extensionInfos.disabled[a.id]=extensionsShare._extensionInfos.enabled[a.id];delete extensionsShare._extensionInfos.enabled[a.id]});
chrome.management.onEnabled.addListener(function(a){_gaq.push(["_trackPageview","/extensions/action/enable/"+a.id+"/"+a.name]);$("#action_disable",$("#"+a.id)).show();$("#"+a.id+" #icon").attr("src",extensionsShare.getImageUrl(a));extensionsShare._extensionInfos.enabled[a.id]=extensionsShare._extensionInfos.disabled[a.id];delete extensionsShare._extensionInfos.disabled[a.id]});
function doI18n(){$("[nodeName=title]").html(_i18n("default_title"));$(".i18n").each(function(){$(this).html(_i18n($(this).attr("id")))});$(".i18nt").each(function(){$(this).attr("title",_i18n($(this).attr("id")))})}
function addListeners(){$(".Wp").toggle(function(){$(this).addClass("Wo").removeClass("Wi");$(".extension."+$(this).parents(".splitter").attr("id").replace("splitter-","")).addClass("hd")},function(){$(this).addClass("Wi").removeClass("Wo");$(".extension."+$(this).parents(".splitter").attr("id").replace("splitter-","")).removeClass("hd")});$(".action").tipTip({maxWidth:"auto",edgeOffset:2,fadeIn:0,fadeOut:0});$("#description").click(function(){_gaq.push(["_trackPageview","/option/description/"+extensionsShare.getLastExportType()+
"/"+$("#description").val()]);extensionsShare.reExport()});$(".ui-widget-overlay").live("click",function(){$("#dialog-modal").dialog("close")});$(".extension").hover(function(){$(".extension-actions",this).show()},function(){$(".extension-actions",this).hide()}).click(function(){$(this).hasClass("selected")?$(this).removeClass("selected"):$(this).addClass("selected")});$(".stars").toggle(function(){$(this).addClass("selected");$(this).parents(".extension").addClass("selected")},function(){$(this).removeClass("selected");
$(this).parents(".extension").removeClass("selected")});$("span#share_twitter").click(function(){var a=extensionsShare.getExtensionInfoById($(this).parents(".extension").attr("id"));if(a!=null){var d=" Chrome Extension";if(a.isApp)d=" Chrome App";_gaq.push(["_trackPageview","/extensions/share/twitter/"+a.id+"/"+a.name]);a=encodeURIComponent(a.name+d)+"&url="+encodeURIComponent("https://chrome.google.com/webstore/detail/"+a.id);window.open("http://twitter.com/share?_=1299226766058&count=horizontal&text="+
a+"&via=ShareExtensions");return false}});$("span#share_buzz").click(function(){var a=extensionsShare.getExtensionInfoById($(this).parents(".extension").attr("id"));if(a!=null){var d=" Chrome Extension";if(a.isApp)d=" Chrome App";_gaq.push(["_trackPageview","/extensions/share/buzz/"+a.id+"/"+a.name]);window.open("http://www.google.com/buzz/post?message="+encodeURIComponent(a.name+d)+"&imageurl="+encodeURIComponent("https://chrome.google.com/webstore/img/"+a.id+"/2323432/logo128")+"&url="+encodeURIComponent("https://chrome.google.com/webstore/detail/"+
a.id));return false}});$("span#share_gmail").click(function(){var a=extensionsShare.getExtensionInfoById($(this).parents(".extension").attr("id"));if(a!=null){var d=_i18n("title_export_mail");if(a.isApp)d=_i18n("title_export_mail_app");_gaq.push(["_trackPageview","/extensions/share/mail/"+a.id+"/"+a.name]);window.open("https://mail.google.com/mail/?view=cm&fs=1&tf=1&su="+encodeURIComponent(d)+"&body="+encodeURIComponent(getDescriptionText(a,true)));return false}});$("span#share_glist").click(function(){var a=
extensionsShare.getExtensionInfoById($(this).parents(".extension").attr("id"));if(a!=null){_i18n("title_export_mail");a.isApp&&_i18n("title_export_mail_app");_gaq.push(["_trackPageview","/extensions/share/glist/"+a.id+"/"+a.name]);window.open("https://www.google.com/bookmarks/api/bookmarklet?output=popup&srcUrl="+encodeURIComponent("https://chrome.google.com/webstore/detail/"+a.id)+"&snippet="+encodeURIComponent(a.description)+"&title="+encodeURIComponent(a.name));return false}});$("span#action_enable").click(function(){$(this).hide();
chrome.management.setEnabled($(this).parents(".extension").attr("id"),true);return false});$("span#action_disable").click(function(){$(this).hide();chrome.management.setEnabled($(this).parents(".extension").attr("id"),false);return false})};